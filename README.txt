More than 50% refactored by VRK